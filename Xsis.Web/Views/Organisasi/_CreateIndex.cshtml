<style type="text/css">
    [data-validation-message] {
        display: none;
        color: red;
        font-weight: bold;
    }

        [data-validation-message].message-visible {
            display: block;
        }

    .blueborder {
        border-color: blue;
    }

        .blueborder.invalid {
            border-color: red;
        }
</style>
<style>
    .body {
        color: #000080;
    }
</style>
<form action="" method="post" id="idFrmSubmitOrganisasiCreateIndex" class="body">
    <div class="row">
        <div class="col-lg-6">
            <label>Nama Organisasi *</label>
            <input type="text" name="name" data-validate="required" class="form-control blueborder" id="idInpNamaOrganisasi">
            <input type="hidden" name="biodata_id" id="idBiodataget" />
            <small role="alert" aria-hidden="true" data-validation-message="required">Nama Organisasi Harus Diisi.</small>
        </div>

        <div class="col-lg-6">
            <label>Jabatan *</label>
            <input type="text" name="position" data-validate="required" class="form-control blueborder" id="idInpJabatan">
            <small role="alert" aria-hidden="true" data-validation-message="required">Jabatan Harus Diisi.</small>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-6">
            <label>Tahun Masuk *</label>
            <select class="form-control blueborder" data-validate="required" name="entry_year" id="idInpTahunMasuk">
                <option value="">-Pilih-</option>
                @*<option value="2011">2011</option>
                    <option value="2012">2012</option>
                    <option value="2013">2013</option>
                    <option value="2014">2014</option>
                    <option value="2015">2015</option>*@
            </select>
            <small role="alert" aria-hidden="true" data-validation-message="required">Tanggal Masuk Harus Diisi.</small>
        </div>

        <div class="col-lg-6">
            <label>Tahun Keluar *</label>
            <select class="form-control blueborder" data-validate="required years" name="exit_year" id="idInpTahunKeluar">
                <option value="">-Pilih-</option>
                @*<option value="2011">2011</option>
                    <option value="2012">2012</option>
                    <option value="2013">2013</option>
                    <option value="2014">2014</option>
                    <option value="2015">2015</option>*@
            </select>
            <small role="alert" aria-hidden="true" data-validation-message="required">Tahun Keluar Harus Diisi.</small>
            <small role="alert" aria-hidden="true" data-validation-message="years">Tanggal Keluar Tidak Valid.</small>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <label>Tanggung Jawab</label>
            <input type="text" name="responsibility" class="form-control blueborder" id="idInpTanggungJawab">
        </div>
    </div>

    <div class="row">
        <div class="col-lg-12">
            <label>Catatan</label>
            <textarea class="form-control blueborder" id="txtarea" name="notes"></textarea>
        </div>
    </div>

    <div class="row">
        <table align="right">
            <tr>
                <td colspan="1">
                    <div class="btn btn-group">

                        <button type="button" class="btn orenwoy" id="idBtnCancelOrganisasiCreateIndex">&nbsp;&nbsp;Batal&nbsp;&nbsp;</button>
                        <button type="submit" class="btn biruwoy" id="idBtnSubmitOrganisasiCreateIndex">Simpan</button>
                    </div>
                </td>
            </tr>
        </table>
    </div>
</form>

<div class="modal fade" id="idMdlIndexOrganisasi" tabindex="-1" role="dialog" data-keyboard="false" data-backdrop="static">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header birubg">
                @*<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>*@
                <h4 class="modal-title" style="color: white; opacity:1;">
                    Detil Pelamar
                    @*<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="color: white; opacity:1;">x</button>*@
                    <button class="pull-right" id="idBtnCloseIndexOrganisasi" style="background-color:transparent; border:none; overflow:hidden;"><span class="glyphicon glyphicon-remove"></span></button>
                </h4>
            </div>
            <div class="modal-body" id="idBodyIndexOrganisasi" style="margin-left: 10px;">

                <div class="row">
                    <div class="col-lg-3 sidebar">
                        <ul class="widget widget-menu unstyled batas-atas batas-bawah" style="background-color: white; border-style: solid; border-width: 1px;border-color:#000066;">
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages01">
                                    Profil
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages02">
                                    Biodata
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages03">
                                    Pengalaman Kerja
                                </a>
                            </li>
                            <li>
                                <a class="collapsed center-block" data-toggle="collapse" href="#togglePages03">
                                    Pendidikan
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages05">
                                    Pelatihan
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages06">
                                    Sertifikasi
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages07">
                                    Sumber Lowongan Kerja
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages01">
                                    Organisasi
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages02">
                                    Biodata
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages03">
                                    Keluarga
                                </a>
                            </li>
                            <li>
                                <a class="collapsed center-block" data-toggle="collapse" href="#togglePages03">
                                    Keahlian
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages05">
                                    Lain-Lain
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages06">
                                    Dokumen
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages07">
                                    Catatan
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages05">
                                    Aktifasi Akun
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages06">
                                    Lihat Tes
                                </a>
                            </li>
                            <li>
                                <a class="collapsed" data-toggle="collapse" href="#togglePages07">
                                    Hasil Tes
                                </a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-lg-9 table-responsive" style="height:600px">
                        <table class="table table-striped">
                            <thead>
                                <tr style="border-bottom: 3px solid #000080">
                                    <td colspan="4">
                                        <h4 class="biru">Organisasi<button type="button" class="btn btn-link" id="idBtnMdlCreateOrganisasi"><span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span></button></h4>
                                    </td>
                                </tr>
                                <tr class="biru" style="border-bottom: 3px solid #000080">
                                    <td>NAMA</td>
                                    <td>JABATAN</td>
                                    <td>PERIODE</td>
                                    <td>#</td>
                                </tr>
                            </thead>
                            <tbody id="idTblMdlBodyOrganisasi"></tbody>
                        </table>
                    </div>
                </div>


                @*<p>One fine body&hellip;</p>*@
            </div>
            @*<div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary">Save changes</button>
                </div>*@
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->


<script>
    var d = new Date();
    //var vBiodata_Id = idBiodata;
    var vBiodata_Id = 1;
    $(document).ready(function () {
        var vTahun = "";
        debugger;
        for (var i = d.getFullYear(); i > 1970; i--) {
            vTahun = vTahun +
                '<option>' + i + '</option>'
        }
        $('#idInpTahunMasuk').append(vTahun);
        $('#idInpTahunKeluar').append(vTahun);

        $('#idBiodataget').val(vBiodata_Id);

    });
    $('#idBtnCancelOrganisasiCreateIndex').click(function () {
        debugger;
        $('#idMdlCreateOrganisasiIndex').close;
        $('#idMdlIndexOrganisasi').close;
        location.reload();
        $('#idMdlIndexOrganisasi').modal('show');
    });

    $('#idBtnCloseIndexOrganisasi').click(function () {
        $('#idMdlCreateOrganisasiIndex').close;
        location.reload();
    });

    //$('#idBtnSubmitOrganisasiCreateIndex').click(function () {
    function simpanorganisasicreateindex(){
        debugger;
        var vDatabarang = $('#idFrmSubmitOrganisasiCreateIndex').serialize();
        $.ajax({
            url: '/Organisasi/Save',
            data: vDatabarang,
            method: 'Post',
            success: function (mdl) {
                debugger;
                if (mdl.Simpan == "Berhasil") {
                    location.reload();
                    $('#idMdlIndexOrganisasi').modal('show');
                    alert("Data berhasil disimpan");
                    //
                    //
                    //$('#idMdlCreateOrganisasi').close;


                }
                else {
                    debugger;
                    alert("Data gagal disimpan");
                }
            }
        });
    }

    $('#idBtnSubmitOrganisasiCreateIndex').click(function () {
        debugger;
        $('#idTblMdlBodyOrganisasi').empty();
        var vStrMdlHtml = '';
        $.ajax({
            url: '/Organisasi/Tampil',
            data: { idBiodata: biodata_id },
            method: 'Get',
            success: function (org) {
                debugger;


                $.each(org, function (index, data) {
                    debugger;
                    if (data.entry_year == data.exit_year) {
                        data.exit_year = '';
                    }
                    else {
                        data.exit_year = ' s.d ' + data.exit_year;
                    }

                    vStrMdlHtml = vStrMdlHtml + '<tr>' +
                        '<td style="border-top: 1px solid #000080">' + data.name + '</td>' +
                        '<td style="border-top: 1px solid #000080">' + data.position + '</td>' +
                        '<td style="border-top: 1px solid #000080">' + data.entry_year + data.exit_year + '</td>' +
                        '<td class="dropdown" style="border-top: 1px solid #000080">' +
                        '<button class="btn birubg dropdown-toggle" type="button" data-toggle="dropdown">More &nbsp;' +
                        '<span class="caret"></span>' +
                        '</button>' +
                        '<ul class="dropdown-menu">' +
                        '<li><a class="UbahOrganisasi" dataID="' + data.id + '" href="#">Ubah</a></li>' +
                        '<li><a class="HapusOrganisasiConfirm" dataID="' + data.id + '" href="#">Hapus</a></li>' +
                        '</ul>' +
                        '</td>' +
                        '</tr>';

                });


                $('#idTblMdlBodyOrganisasi').append(vStrMdlHtml);


                $('#idMdlIndexOrganisasi').modal('show');


            },
            error: function (org) {
                debugger;
            }
        });
    });
</script>

<script>
// (1) Defining our validator-functions
//     for later use. They return
//     "true", if the validation passes.
const validators = {
  // Checks the field for emptiness.
    required: element => element.value.length > 0,
    years: element=>element.value >= document.getElementById("idInpTahunMasuk").value,

  // Checks if there are no numbers
  // in the field.
  noNumbers: element => !element.value.match(/[0-9]/g),

  // Checks if the value is shorter
  // than 10 characters.
  maxLength: element => element.value.length <= 10,

  // Checks if the checkbox is checked.
  mustBeChecked: element => element.checked
};

// (2) Check the contents of an input,
//     get all validators, and mark
//     the field in case of invalidity.
function validateElement(element) {
  resetValidation(element);

  // Store all validators from the
  // data-validate-attribute into
  // an array.
  const rules = element.dataset.validate.split(" ");

  // For every validator on the
  // field...
  rules.forEach(rule => {
    // ...find the corresponding
    // validator-function from our
    // object from #1 and call it
    // with the element as parameter.
    if (validators[rule](element)) {
      // If the function returns true, all is fine.
        debugger;
        return;
    } else {
      // If it returns false, the
      // validation failed.
      // In that case, the
      // markElementInvalid-function
      // takes care of showing the
      // error-message.
      markElementInvalid(element, rule);
    }
  });
}

// (3) Adds classes to an element,
//     so it appears invalid. Also
//     it picks the correct feedback-
//     message and sets it visible.
function markElementInvalid(element, validatorName) {
  element.classList.add("invalid");
  element.setAttribute("aria-invalid", true);
  const feedbackMessage = element.parentNode.querySelector(
    `[data-validation-message=${validatorName}]`
  );
  feedbackMessage.classList.add("message-visible");
  feedbackMessage.setAttribute("aria-hidden", false);
}

// (4) Removes all traces of
//     validation from an element,
//     like the error-messages and
//     the styling.
//     (Pretty much the opposite of #3)
function resetValidation(element) {
  element.classList.remove("invalid");
  element.setAttribute("aria-invalid", false);
  element.parentNode
    .querySelectorAll("[data-validation-message]")
    .forEach(e => {
      e.classList.remove("message-visible");
      e.setAttribute("aria-hidden", true);
    });
}

// (5) Store the form and its
//     inputs in variables.
const form = document.getElementById("idFrmSubmitOrganisasiCreateIndex");
const formElements = Array.from(form.elements);

// (6) Every input gets an
//     event-listener attached.
formElements.forEach(formElement => {
  // Do nothing if the element has
  // no data-validate-attribute.
  if (!formElement.dataset) return;
  if (!formElement.dataset.validate) return;

  // Attach the blur-event-listener
  // to the element.
  formElement.addEventListener("", () => {
    // This means, validateElement will
    // be called everytime the element
    // loses focus.
    validateElement(formElement);
  });
});

// (7) We're doing what we did at #3,
//     only on form-submit, and for
//     every field.
form.addEventListener("submit", event => {
  // Let's assume, everything is fine.
  let formIsValid = true;
  form.classList.remove("invalid");

  // We'll check every field in the form.
  // (same as #3)
  formElements.forEach(formElement => {
    if (!formElement.dataset) return;
    if (!formElement.dataset.validate) return;
    validateElement(formElement);
  });

  // If there are any "invalid"-classes
  // after we checked all fields, the form
  // is invalid...
  formIsValid = form.querySelectorAll(".invalid").length === 0;

  // ...and will not be submitted.
  if (formIsValid === false) {
    form.classList.add("invalid");
    event.preventDefault();
  } else {
      debugger;
      simpanorganisasicreateindex();
  }
});
</script>
